<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch·∫©n ƒëo√°n b·ªánh suy th·∫≠n m·∫°n t√≠nh (CKD)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .header {
            background: linear-gradient(135deg, #0066cc 0%, #0099ff 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            border-radius: 0 0 20px 20px;
        }
        .card {
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border: none;
        }
        .card-header {
            background-color: #0066cc;
            color: white;
            border-radius: 15px 15px 0 0 !important;
            font-weight: bold;
        }
        .form-section {
            margin-bottom: 1.5rem;
            padding-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
        }
        .form-section h5 {
            color: #0066cc;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #0066cc;
        }
        .form-label {
            font-weight: 500;
            color: #333;
        }
        .required::after {
            content: " *";
            color: #dc3545;
        }
        .result-box {
            display: none;
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .result-positive {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e8e 100%);
            color: white;
        }
        .result-negative {
            background: linear-gradient(135deg, #20c997 0%, #3dd9a7 100%);
            color: white;
        }
        .btn-primary {
            background: linear-gradient(135deg, #0066cc 0%, #0099ff 100%);
            border: none;
            padding: 12px 30px;
            font-weight: bold;
            font-size: 1.1rem;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #0055aa 0%, #0088ee 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,102,204,0.3);
        }
        .help-text {
            font-size: 0.85rem;
            color: #666;
            font-style: italic;
        }
        .footer {
            text-align: center;
            margin-top: 3rem;
            padding: 1.5rem;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid #dee2e6;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-5 fw-bold">
                        <i class="bi bi-heart-pulse"></i> H·ªá th·ªëng ch·∫©n ƒëo√°n b·ªánh suy th·∫≠n m·∫°n t√≠nh
                    </h1>
                    <p class="lead mb-0">S·ª≠ d·ª•ng m√¥ h√¨nh ANN ƒë·ªÉ d·ª± ƒëo√°n nguy c∆° CKD</p>
                </div>
                <div class="col-md-4 text-end">
                    <div class="bg-white text-primary rounded-pill px-3 py-2 d-inline-block">
                        <small>ƒê·ªô ch√≠nh x√°c: 85%</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <!-- Form nh·∫≠p li·ªáu -->
            <div class="col-lg-8">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0"><i class="bi bi-clipboard-data"></i> Nh·∫≠p th√¥ng tin b·ªánh nh√¢n</h4>
                    </div>
                    <div class="card-body">
                        <form id="ckdForm">
                            <!-- Features theo ƒë√∫ng th·ª© t·ª± trong model -->
                            <div class="form-section">
                                <h5>Th√¥ng tin c∆° b·∫£n</h5>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label required">Tu·ªïi (age)</label>
                                        <input type="number" class="form-control" id="age" name="age" min="0" max="120" step="1" required>
                                        <div class="help-text">Tu·ªïi b·ªánh nh√¢n (nƒÉm)</div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label required">Huy·∫øt √°p (bp)</label>
                                        <input type="number" class="form-control" id="bp" name="bp" min="0" max="300" step="0.1" required>
                                        <div class="help-text">Huy·∫øt √°p t√¢m thu (mmHg)</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h5>X√©t nghi·ªám n∆∞·ªõc ti·ªÉu</h5>
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">T·ª∑ tr·ªçng (sg)</label>
                                        <input type="number" class="form-control" id="sg" name="sg" min="1.000" max="1.050" step="0.001" required>
                                        <div class="help-text">1.005-1.030</div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">Albumin (al)</label>
                                        <input type="number" class="form-control" id="al" name="al" min="0" max="5" step="1" required>
                                        <div class="help-text">0-4: B√¨nh th∆∞·ªùng, 5: R·∫•t cao</div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">ƒê∆∞·ªùng (su)</label>
                                        <input type="number" class="form-control" id="su" name="su" min="0" max="5" step="1" required>
                                        <div class="help-text">0: Kh√¥ng c√≥, 1-5: M·ª©c ƒë·ªô c√≥ ƒë∆∞·ªùng</div>
                                    </div>
                                    
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">H·ªìng c·∫ßu (rbc)</label>
                                        <select class="form-select" id="rbc" name="rbc" required>
                                            <option value="0">B√¨nh th∆∞·ªùng</option>
                                            <option value="1">B·∫•t th∆∞·ªùng</option>
                                        </select>
                                        <div class="help-text">0: normal, 1: abnormal</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">T·∫ø b√†o m·ªß (pc)</label>
                                        <select class="form-select" id="pc" name="pc" required>
                                            <option value="0">B√¨nh th∆∞·ªùng</option>
                                            <option value="1">B·∫•t th∆∞·ªùng</option>
                                        </select>
                                        <div class="help-text">0: normal, 1: abnormal</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">C·ª•m TB m·ªß (pcc)</label>
                                        <select class="form-select" id="pcc" name="pcc" required>
                                            <option value="0">Kh√¥ng c√≥</option>
                                            <option value="1">C√≥</option>
                                        </select>
                                        <div class="help-text">0: notpresent, 1: present</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">Vi khu·∫©n (ba)</label>
                                        <select class="form-select" id="ba" name="ba" required>
                                            <option value="0">Kh√¥ng c√≥</option>
                                            <option value="1">C√≥</option>
                                        </select>
                                        <div class="help-text">0: notpresent, 1: present</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h5>X√©t nghi·ªám m√°u</h5>
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">ƒê∆∞·ªùng huy·∫øt (bgr)</label>
                                        <input type="number" class="form-control" id="bgr" name="bgr" min="0" max="500" step="1" required>
                                        <div class="help-text">ƒê∆∞·ªùng huy·∫øt ng·∫´u nhi√™n (mg/dL)</div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">Ure m√°u (bu)</label>
                                        <input type="number" class="form-control" id="bu" name="bu" min="0" max="200" step="0.1" required>
                                        <div class="help-text">Ure m√°u (mg/dL)</div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">Creatinine (sc)</label>
                                        <input type="number" class="form-control" id="sc" name="sc" min="0" max="20" step="0.01" required>
                                        <div class="help-text">Creatinine huy·∫øt thanh (mg/dL)</div>
                                    </div>
                                    
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">Natri (sod)</label>
                                        <input type="number" class="form-control" id="sod" name="sod" min="100" max="200" step="0.1" required>
                                        <div class="help-text">N·ªìng ƒë·ªô natri (mEq/L)</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">Kali (pot)</label>
                                        <input type="number" class="form-control" id="pot" name="pot" min="2" max="8" step="0.1" required>
                                        <div class="help-text">N·ªìng ƒë·ªô kali (mEq/L)</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">Hemoglobin (hemo)</label>
                                        <input type="number" class="form-control" id="hemo" name="hemo" min="0" max="20" step="0.1" required>
                                        <div class="help-text">Hemoglobin (g/dL)</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">PCV</label>
                                        <input type="number" class="form-control" id="pcv" name="pcv" min="0" max="70" step="0.1" required>
                                        <div class="help-text">Th·ªÉ t√≠ch kh·ªëi h·ªìng c·∫ßu (%)</div>
                                    </div>
                                    
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">B·∫°ch c·∫ßu (wc)</label>
                                        <input type="number" class="form-control" id="wc" name="wc" min="0" max="20000" step="1" required>
                                        <div class="help-text">S·ªë l∆∞·ª£ng b·∫°ch c·∫ßu (cells/cumm)</div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <label class="form-label required">H·ªìng c·∫ßu (rc)</label>
                                        <input type="number" class="form-control" id="rc" name="rc" min="0" max="10" step="0.01" required>
                                        <div class="help-text">S·ªë l∆∞·ª£ng h·ªìng c·∫ßu (millions/cmm)</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h5>B·ªánh n·ªÅn v√† tri·ªáu ch·ª©ng</h5>
                                <div class="row">
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">TƒÉng huy·∫øt √°p (htn)</label>
                                        <select class="form-select" id="htn" name="htn" required>
                                            <option value="0">Kh√¥ng</option>
                                            <option value="1">C√≥</option>
                                        </select>
                                        <div class="help-text">0: no, 1: yes</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">ƒê√°i th√°o ƒë∆∞·ªùng (dm)</label>
                                        <select class="form-select" id="dm" name="dm" required>
                                            <option value="0">Kh√¥ng</option>
                                            <option value="1">C√≥</option>
                                        </select>
                                        <div class="help-text">0: no, 1: yes</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">B·ªánh m·∫°ch v√†nh (cad)</label>
                                        <select class="form-select" id="cad" name="cad" required>
                                            <option value="0">Kh√¥ng</option>
                                            <option value="1">C√≥</option>
                                        </select>
                                        <div class="help-text">0: no, 1: yes</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">Ch√°n ƒÉn (appet)</label>
                                        <select class="form-select" id="appet" name="appet" required>
                                            <option value="0">B√¨nh th∆∞·ªùng</option>
                                            <option value="1">K√©m</option>
                                        </select>
                                        <div class="help-text">0: good, 1: poor</div>
                                    </div>
                                    
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">Ph√π (pe)</label>
                                        <select class="form-select" id="pe" name="pe" required>
                                            <option value="0">Kh√¥ng</option>
                                            <option value="1">C√≥</option>
                                        </select>
                                        <div class="help-text">0: no, 1: yes</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label class="form-label required">Thi·∫øu m√°u (ane)</label>
                                        <select class="form-select" id="ane" name="ane" required>
                                            <option value="0">Kh√¥ng</option>
                                            <option value="1">C√≥</option>
                                        </select>
                                        <div class="help-text">0: no, 1: yes</div>
                                    </div>
                                </div>
                            </div>

                            <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                                <button type="button" class="btn btn-secondary me-md-2" onclick="fillSampleData('ckd')">
                                    <i class="bi bi-file-earmark-medical"></i> M·∫´u CKD
                                </button>
                                <button type="button" class="btn btn-secondary me-md-2" onclick="fillSampleData('notckd')">
                                    <i class="bi bi-file-earmark-check"></i> M·∫´u kh√¥ng CKD
                                </button>
                                <button type="button" class="btn btn-warning me-md-2" onclick="validateForm()">
                                    <i class="bi bi-check-circle"></i> Ki·ªÉm tra
                                </button>
                                <button type="submit" class="btn btn-primary" id="submitBtn">
                                    <i class="bi bi-calculator"></i> Ch·∫©n ƒëo√°n
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- K·∫øt qu·∫£ v√† th√¥ng tin -->
            <div class="col-lg-4">
                <div class="card result-box" id="resultCard">
                    <div class="card-header" id="resultHeader">
                        <h4 class="mb-0"><i class="bi bi-graph-up"></i> K·∫øt qu·∫£ ch·∫©n ƒëo√°n</h4>
                    </div>
                    <div class="card-body">
                        <div class="text-center mb-4">
                            <div id="resultIcon" style="font-size: 5rem;"></div>
                            <h3 id="resultTitle" class="mt-3 mb-2"></h3>
                            <div id="resultSubtitle" class="mb-4"></div>
                        </div>
                        
                        <div class="mb-4">
                            <h5>X√°c su·∫•t d·ª± ƒëo√°n:</h5>
                            <div class="progress mb-2" style="height: 25px;">
                                <div id="ckdProgress" class="progress-bar bg-danger" role="progressbar" style="width: 0%"></div>
                                <div id="notCkdProgress" class="progress-bar bg-success" role="progressbar" style="width: 100%"></div>
                            </div>
                            <div class="row">
                                <div class="col-6 text-danger">
                                    <strong>M·∫Øc CKD:</strong> <span id="ckdPercent">0%</span>
                                </div>
                                <div class="col-6 text-success text-end">
                                    <strong>Kh√¥ng CKD:</strong> <span id="notCkdPercent">100%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="alert alert-info" id="recommendation">
                            <h6><i class="bi bi-lightbulb"></i> Khuy·∫øn ngh·ªã:</h6>
                            <p id="recommendationText"></p>
                        </div>
                        
                        <div class="alert alert-warning small">
                            <i class="bi bi-exclamation-triangle"></i> <strong>L∆∞u √Ω:</strong> ƒê√¢y l√† k·∫øt qu·∫£ t·ª´ AI, c·∫ßn tham kh·∫£o √Ω ki·∫øn b√°c sƒ©.
                        </div>
                        
                        <button class="btn btn-outline-primary w-100" onclick="resetForm()">
                            <i class="bi bi-arrow-repeat"></i> Ch·∫©n ƒëo√°n m·ªõi
                        </button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0"><i class="bi bi-info-circle"></i> Th√¥ng tin h·ªá th·ªëng</h4>
                    </div>
                    <div class="card-body">
                        <p><strong>Model:</strong> ANN (3 hidden layers)</p>
                        <p><strong>ƒê·ªô ch√≠nh x√°c:</strong> 85% tr√™n test set</p>
                        <p><strong>S·ªë features:</strong> 24</p>
                        <p><strong>API Status:</strong> <span id="apiStatus" class="badge bg-success">Online</span></p>
                        <hr>
                        <p class="small mb-0">
                            <i class="bi bi-github"></i> 
                            <strong>Feature order:</strong>
                            <code class="d-block mt-1 small">age,bp,sg,al,su,rbc,pc,pcc,ba,bgr,bu,sc,sod,pot,hemo,pcv,wc,rc,htn,dm,cad,appet,pe,ane</code>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>¬© 2025 - ƒê·ªÅ t√†i "Nghi√™n c·ª©u v√† x√¢y d·ª±ng m√¥ h√¨nh d·ª± ƒëo√°n nguy c∆° m·∫Øc b·ªánh suy th·∫≠n"</p>
            <p>Nh√≥m 05 - L·ªõp 20251IT6122002 - Tr∆∞·ªùng ƒê·∫°i h·ªçc C√¥ng nghi·ªáp H√† N·ªôi</p>
            <p class="small">S·ª≠ d·ª•ng m√¥ h√¨nh m·∫°ng n∆°-ron nh√¢n t·∫°o (ANN)</p>
        </div>
    </div>

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // API URL
        const API_URL = '/predict';

        
        // Debug: In ra feature order
        console.log("Feature order trong model:", [
            "age","bp","sg","al","su","rbc","pc","pcc","ba",
            "bgr","bu","sc","sod","pot","hemo","pcv","wc","rc",
            "htn","dm","cad","appet","pe","ane"
        ]);

        // D·ªØ li·ªáu m·∫´u CKD
        const SAMPLE_CKD = {
            age: 65,
            bp: 80,
            sg: 1.010,
            al: 4,
            su: 0,
            rbc: 1,  // abnormal
            pc: 1,   // abnormal
            pcc: 0,  // notpresent
            ba: 0,   // notpresent
            bgr: 148,
            bu: 56,
            sc: 3.8,
            sod: 137,
            pot: 4.6,
            hemo: 11.2,
            pcv: 38,
            wc: 7800,
            rc: 4.5,
            htn: 1,  // yes
            dm: 1,   // yes
            cad: 0,  // no
            appet: 1, // poor
            pe: 1,   // yes
            ane: 1   // yes
        };

        // D·ªØ li·ªáu m·∫´u kh√¥ng CKD
        const SAMPLE_NOT_CKD = {
            age: 45,
            bp: 120,
            sg: 1.025,
            al: 0,
            su: 0,
            rbc: 0,  // normal
            pc: 0,   // normal
            pcc: 0,  // notpresent
            ba: 0,   // notpresent
            bgr: 90,
            bu: 12,
            sc: 0.8,
            sod: 142,
            pot: 3.8,
            hemo: 14.5,
            pcv: 44,
            wc: 6500,
            rc: 5.2,
            htn: 0,  // no
            dm: 0,   // no
            cad: 0,  // no
            appet: 0, // good
            pe: 0,   // no
            ane: 0   // no
        };

        // X·ª≠ l√Ω form submit
        document.getElementById('ckdForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            await predictCKD();
        });

        // H√†m ki·ªÉm tra form
        function validateForm() {
            const form = document.getElementById('ckdForm');
            if (!form.checkValidity()) {
                form.classList.add('was-validated');
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß t·∫•t c·∫£ c√°c tr∆∞·ªùng b·∫Øt bu·ªôc!');
                return false;
            }
            
            // L·∫•y v√† hi·ªÉn th·ªã d·ªØ li·ªáu ƒë√£ nh·∫≠p
            const formData = getFormData();
            console.log("D·ªØ li·ªáu form ƒë√£ nh·∫≠p:", formData);
            
            // Hi·ªÉn th·ªã d·ªØ li·ªáu JSON
            alert('Form h·ª£p l·ªá! D·ªØ li·ªáu:\n' + JSON.stringify(formData, null, 2));
            return true;
        }

        // L·∫•y d·ªØ li·ªáu t·ª´ form
        function getFormData() {
            return {
                age: parseFloat(document.getElementById('age').value),
                bp: parseFloat(document.getElementById('bp').value),
                sg: parseFloat(document.getElementById('sg').value),
                al: parseFloat(document.getElementById('al').value),
                su: parseFloat(document.getElementById('su').value),
                rbc: parseInt(document.getElementById('rbc').value),
                pc: parseInt(document.getElementById('pc').value),
                pcc: parseInt(document.getElementById('pcc').value),
                ba: parseInt(document.getElementById('ba').value),
                bgr: parseFloat(document.getElementById('bgr').value),
                bu: parseFloat(document.getElementById('bu').value),
                sc: parseFloat(document.getElementById('sc').value),
                sod: parseFloat(document.getElementById('sod').value),
                pot: parseFloat(document.getElementById('pot').value),
                hemo: parseFloat(document.getElementById('hemo').value),
                pcv: parseFloat(document.getElementById('pcv').value),
                wc: parseFloat(document.getElementById('wc').value),
                rc: parseFloat(document.getElementById('rc').value),
                htn: parseInt(document.getElementById('htn').value),
                dm: parseInt(document.getElementById('dm').value),
                cad: parseInt(document.getElementById('cad').value),
                appet: parseInt(document.getElementById('appet').value),
                pe: parseInt(document.getElementById('pe').value),
                ane: parseInt(document.getElementById('ane').value)
            };
        }

        // H√†m d·ª± ƒëo√°n
        async function predictCKD() {
            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.innerHTML;
            
            // Hi·ªÉn th·ªã loading
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> ƒêang ph√¢n t√≠ch...';
            
            try {
                // L·∫•y d·ªØ li·ªáu t·ª´ form
                const formData = getFormData();
                
                // Debug: In ra d·ªØ li·ªáu g·ª≠i ƒëi
                console.log("üì§ G·ª≠i d·ªØ li·ªáu ƒë·∫øn API:", formData);
                console.log("üìã Th·ª© t·ª± features:", Object.keys(formData));
                
                // G·ªçi API
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                console.log("üì• Nh·∫≠n k·∫øt qu·∫£ t·ª´ API:", result);
                
                // Hi·ªÉn th·ªã k·∫øt qu·∫£
                displayResult(result);
                
            } catch (error) {
                console.error('‚ùå L·ªói:', error);
                alert('C√≥ l·ªói x·∫£y ra khi k·∫øt n·ªëi ƒë·∫øn m√°y ch·ªß. Vui l√≤ng th·ª≠ l·∫°i sau.\nChi ti·∫øt: ' + error.message);
            } finally {
                // Kh√¥i ph·ª•c n√∫t
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
            }
        }

        // Hi·ªÉn th·ªã k·∫øt qu·∫£
        function displayResult(result) {
            const resultCard = document.getElementById('resultCard');
            const resultHeader = document.getElementById('resultHeader');
            const resultIcon = document.getElementById('resultIcon');
            const resultTitle = document.getElementById('resultTitle');
            const resultSubtitle = document.getElementById('resultSubtitle');
            const ckdProgress = document.getElementById('ckdProgress');
            const notCkdProgress = document.getElementById('notCkdProgress');
            const ckdPercent = document.getElementById('ckdPercent');
            const notCkdPercent = document.getElementById('notCkdPercent');
            const recommendationText = document.getElementById('recommendationText');
            
            const ckdProb = (result.probability_ckd * 100).toFixed(1);
            const notCkdProb = (result.probability_not_ckd * 100).toFixed(1);
            
            // C·∫≠p nh·∫≠t progress bars
            ckdProgress.style.width = ckdProb + '%';
            notCkdProgress.style.width = notCkdProb + '%';
            ckdPercent.textContent = ckdProb + '%';
            notCkdPercent.textContent = notCkdProb + '%';
            
            if (result.prediction === 1) {
                // K·∫øt qu·∫£ d∆∞∆°ng t√≠nh (CKD)
                resultHeader.className = 'card-header result-positive';
                resultIcon.innerHTML = '<i class="bi bi-exclamation-triangle-fill text-danger"></i>';
                resultTitle.className = 'text-danger fw-bold';
                resultSubtitle.className = 'text-danger';
                resultSubtitle.innerHTML = `<span class="badge bg-light text-danger fs-6">D∆∞∆°ng t√≠nh (${ckdProb}%)</span>`;
                resultSubtitle.className = 'text-white';
                
                recommendationText.textContent = 'B·ªánh nh√¢n c√≥ nguy c∆° m·∫Øc b·ªánh th·∫≠n m·∫°n t√≠nh. Khuy·∫øn ngh·ªã: Th·ª±c hi·ªán c√°c x√©t nghi·ªám chuy√™n s√¢u, tham kh·∫£o √Ω ki·∫øn b√°c sƒ© chuy√™n khoa th·∫≠n, theo d√µi huy·∫øt √°p v√† ƒë∆∞·ªùng huy·∫øt th∆∞·ªùng xuy√™n, h·∫°n ch·∫ø th·ª©c ƒÉn m·∫∑n v√† ƒë·∫°m ƒë·ªông v·∫≠t.';
                
            } else {
                // K·∫øt qu·∫£ √¢m t√≠nh (Not CKD)
                resultHeader.className = 'card-header result-negative';
                resultIcon.innerHTML = '<i class="bi bi-check-circle-fill text-success"></i>';
                resultTitle.className = 'text-success fw-bold';
                resultSubtitle.className = 'text-success';
                resultSubtitle.innerHTML = `<span class="badge bg-light text-success fs-6">√Çm t√≠nh (${notCkdProb}%)</span>`;
                resultSubtitle.className = 'text-white';
                
                recommendationText.textContent = 'B·ªánh nh√¢n hi·ªán kh√¥ng c√≥ d·∫•u hi·ªáu m·∫Øc b·ªánh th·∫≠n m·∫°n t√≠nh. Khuy·∫øn ngh·ªã: Duy tr√¨ l·ªëi s·ªëng l√†nh m·∫°nh, ki·ªÉm tra s·ª©c kh·ªèe ƒë·ªãnh k·ª≥ 6 th√°ng/l·∫ßn, u·ªëng ƒë·ªß n∆∞·ªõc (2-2.5 l√≠t/ng√†y), h·∫°n ch·∫ø th·ª©c ƒÉn m·∫∑n v√† duy tr√¨ c√¢n n·∫∑ng h·ª£p l√Ω.';
            }
            
            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            resultCard.style.display = 'block';
            
            // Cu·ªôn ƒë·∫øn k·∫øt qu·∫£
            resultCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        // ƒêi·ªÅn d·ªØ li·ªáu m·∫´u
        function fillSampleData(type) {
            const sample = type === 'ckd' ? SAMPLE_CKD : SAMPLE_NOT_CKD;
            
            for (const [key, value] of Object.entries(sample)) {
                const element = document.getElementById(key);
                if (element) {
                    if (element.tagName === 'SELECT') {
                        element.value = value;
                    } else {
                        element.value = value;
                    }
                }
            }
            
            alert(`ƒê√£ ƒëi·ªÅn d·ªØ li·ªáu m·∫´u: ${type === 'ckd' ? 'CKD (d∆∞∆°ng t√≠nh)' : 'Kh√¥ng CKD (√¢m t√≠nh)'}`);
        }
        
        // Reset form
        function resetForm() {
            document.getElementById('ckdForm').reset();
            document.getElementById('resultCard').style.display = 'none';
            document.getElementById('age').focus();
        }
        
        // Ki·ªÉm tra API status khi load trang
        window.onload = async function() {
            try {
                const response = await fetch(API_URL.replace('/predict', '/'));
                if (response.ok) {
                    document.getElementById('apiStatus').className = 'badge bg-success';
                    document.getElementById('apiStatus').textContent = 'Online';
                }
            } catch (error) {
                document.getElementById('apiStatus').className = 'badge bg-danger';
                document.getElementById('apiStatus').textContent = 'Offline';
            }
            
            // T·ª± ƒë·ªông focus v√†o √¥ ƒë·∫ßu ti√™n
            document.getElementById('age').focus();
        };
    </script>
</body>
</html>